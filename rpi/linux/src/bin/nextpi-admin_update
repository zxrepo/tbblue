#!/bin/bash

install_update() {
	echo -n "Inspecting Dongle for Update..."
	if [ -f /mnt/dongle/update.log ]; then
		echo "Update.log found - skipping!"
	else 
		if [ -f /mnt/dongle/update.tar ]; then
			echo "Found update - extracting"
			mkdir -p /tmp/update
			cd /tmp/update
			tar -xvf /mnt/dongle/update.tar -C /tmp/update
			#md5sum /tmp/update/stage1.sh | cut -d\  -f1
			bash /tmp/update/stage1.sh | tee /tmp/update.log
		else
			echo "No update found - continuing startup"
		fi
	fi	
	sleep 1
}

nextpi-dongle_enable

echo 
echo "Checking for NextPi Plus Packs"

echo -n "  Developer: "
if [ -f "/mnt/dongle/Developer.img" ]; then
	mount -nr /mnt/dongle/Developer.img /PlusPack/Developer
  echo "done"
else
  echo "not found"
fi

echo -n "  Media: "
if [ -f "/mnt/dongle/Media.img" ]; then
	mount -nr /mnt/dongle/Media.img /PlusPack/Media
  echo "done"
else
  echo "not found"
fi

echo -n "  Runtime: "
if [ -f "/mnt/dongle/Runtime.img" ]; then
	mount -nr /mnt/dongle/Runtime.img /PlusPack/Runtime
  echo "done"
else
  echo "not found"
fi

echo -n "  User: "
if [ -f "/mnt/dongle/User.img" ]; then
	mount -n /mnt/dongle/User.img /PlusPack/User
  echo "done"
else
  echo "not found"
fi

